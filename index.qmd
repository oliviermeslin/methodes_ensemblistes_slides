---
title: Introduction aux m√©thodes ensemblistes
subtitle: |
  **Ou comment booster la statistique publique**
author: |
  M√©lina Hillion
  Olivier Meslin
slide-number: true
footer: |
  M√©thodes ensemblistes
# uncomment for French presentations:
lang: fr-FR
# for blind readers:
slide-tone: false
# for @olevitt:
chalkboard: # press the B key to toggle chalkboard
  theme: whiteboard
# uncomment to use the multiplex mode:
#multiplex: true
format:
  # pick the light mode (onyxia-revealjs) or the dark mode (onyxia-dark-revealjs)
  onyxia-revealjs
  #onyxia-dark-revealjs:
controls: true
css: custom.css
from: markdown+emoji
---

# Intro

## Une belle intro {.smaller}


Friedman 2001, Breiman 2001

XGBoost, LightGBM

## Rattraper le retard pris par la statistique publique {.smaller}

Les m√©thodes ensemblistes sont bien adapt√©es aux travaux de la statistique publique:

- Omnipr√©sence de __[donn√©es tabulaires]{.blue2}__;
- Multiplicit√© des __[cas d'usage]{.blue2}__:
    - __[Classification binaire]{.orange}__: correction de la non-r√©ponse dans les enqu√™tes, rep√©rage d'_outliers_, mod√©lisation, imputation (ex: emploi/ch√¥mage); 
    - __[Classification multiclasse]{.orange}__: imputation (ex: niveau de dipl√¥me);
    - __[R√©gression]{.orange}__: imputation de variables continues (√¢ge, salaires, heures travaill√©es, prix immobiliers), pr√©diction de s√©ries temporelles, lissage spatial...

. . .

Ces m√©thodes restent pourtant __[peu utilis√©es par la statistique publique]{.blue2}__.

## Que voulons-nous faire? {.smaller}

- __[Objectif p√©dagogique]{.orange}__: __[faciliter l'appropriation de ces m√©thodes]{.blue2}__ par la statistique publique $\Rightarrow$ Ce n'est pas un travail de recherche.

. . .

- __[Public]{.orange}__: les __[agents de la statistique publique qui connaissent les cas d'usage et ma√Ætrisent les m√©thodes √©conom√©triques traditionnelles]{.blue2}__, mais sont peu familiers du _machine learning_.

. . .

- __[D√©marche]{.orange}__: faire une __[pr√©sentation d√©taill√©e des m√©thodes ensemblistes]{.blue2}__, assortie de cas d'usage montrant leur apport aux travaux de la statistique publique.

## Champ couvert (1) {.smaller}

- Objectif: [__pr√©senter en d√©tail un nombre r√©duit d'approches__]{.blue2}:
    - CART;
    - _Bagging_ et for√™ts al√©atoires;
    - _Gradient boosting_.


- M√©thodes non couvertes:
    - _Stacking_;
    - _Boosting_ adaptatif.

## Champ couvert (2) {.smaller}


- Objectif: [__pr√©senter quelques m√©thodes d'interpr√©tabilit√©__]{.blue2}:
    - Approches globales (PDP, ALE plots);
    - Approches locales (valeurs de Shapley, LIME);

- Non couvert: mesure de l'incertitude (notamment la pr√©diction conforme).

## Approche p√©dagogique (1) {.smaller}


- Objectif: [__Couvrir toutes les √©tapes de l'appropriation de ces m√©thodes__]{.blue2}:
    - Pr√©sentation intuitive des m√©thodes;
    - Approche math√©matique d√©taill√©e (reprenant Friedman 2001 et Chen et Guestrin 2016);
    - Pr√©sentation des principaux hyper-param√®tres et de leur lien avec les cas d'usage;
    - Mise en oeuvre pratique.


## Exemple de figures: CART

![](./figures/output2.svg)

## Exemple de figures: for√™t al√©atoire

![](./figures/output4.svg)

## Exemple de figures: _gradient boosting_

![](./figures/output5.svg)

## Approche p√©dagogique (2) {.smaller}

- Objectif: [__Proposer diff√©rents cas d'usage tir√©s de la statistique publiques__]{.blue2}n avec des exemples reproductibles reposant sur des donn√©es ouvertes (autant que possible).
    

## Cas d'usage


- Scope du DT.

- Cas d'usage;
    - Classification/r√©gression
    - Repond√©ration dans les enqu√™tes;
    - Lissage spatial => Fid√©limmo

- organisation des cas d'usage.



# Cas d'usage

## Imputation de valeurs manquantes {.smaller}

- Qu'est-ce que l'imputation ?
  - Affecter une valeur "artificielle" √† une valeur manquantes

- Quand imputer ?
  - En pr√©sence de non-r√©ponse partielle

- Pourquoi imputer ?
  - R√©duire les biais (de non-r√©ponse) des estimateurs

- Quels enjeux ?
  - Qualit√© des donn√©es diffus√©es 
  - Variables imput√©es parfois utilis√©es pour imputer les valeurs manquantes d'autres variables (risque d'erreurs "en cascade")
  - La qualit√© des imputations d√©pends de la valeur pr√©dictive des variables auxilaires et de la performance du mod√®le pr√©dictif utilis√©




## Imputation de valeurs manquantes {.smaller}

- Application propos√©e
  - Utiliser les donn√©es publiques du recensement (d√©j√† imput√©es)
  - S√©lectionner quelques variables
  - Comparer les performances pr√©dictives de la m√©thode d'imputation actuelle, d'un logit et d'un xgboost √† partir des m√™mes variables
  
- M√©thode redressement actuelle: s√©quentielle et non d√©terministe (dans un premier temps)
- Exemple: le niveau de dipl√¥me
- Hypoth√®ses: 
  ‚Äì Le dipl√¥me d‚Äôun individu d√©pend de son √¢ge, de sa nationalit√© et de son sexe
  ‚Äì Sans d√©claration, le dipl√¥me d‚Äôun individu se d√©duit probablement de son √¢ge et de sa nationalit√©
    
  
## Imputation de valeurs manquantes {.smaller}

- Avantage et limites de la m√©thode xgboost
- Consid√©rations pratiques pour le d√©ploiement 
  



## Repond√©ration {.smaller}

- Pourquoi am√©liorer la m√©thode de pr√©diction de la non-r√©ponse
  - Am√©liorer la qualit√© des statistiques descriptives diffus√©es
  - Limites de la m√©thode actuelle: l'efficacit√© d√©pend de la qualit√© du mod√®le de probabilit√© de r√©ponse
  



## Repond√©ration {.smaller}

- Application propos√©e
  - Utiliser les donn√©es de gestion de l'enqu√™te patrimoine
  - Pr√©dire la non r√©ponse √† partir des informations issues de la base de sondage
  - M√©thode actuelle: m√©thode des scores 
    - on estime la probabilit√© de r√©ponse de chaque m√©nage par un mod√®le logit
    - on constitue des ensembles de m√©nages de probabilit√© de r√©ponse semblable (scores de propension proches)
    - on multiplie les poids des r√©pondants (poids de sondage) par l‚Äôinverse du taux de r√©ponse de l‚Äôensemble
  - Comparer les performances pr√©dictives de la m√©thode d'imputation actuelle (logit) et d'un xgboost 
    - on utilise les m√™mes variables
    - on remplace uniquement la partie pr√©dictive par la m√©thode xgboost
  



## Lissage spatial {.smaller}





# Le Funathon

## Principe {.smaller}

:::: {.columns}

::: {.column width="70%"}

::: {.incremental}

- __[4 sujets]{.blue2}__ pour d√©couvrir diff√©rents champs de la _data science_
    + Pas une comp√©tition mais des [tutoriels pas √† pas]{.orange}
    + Mais n'h√©sitez pas √† tester des choses nouvelles üòç <br><br>
- [**_"D√©collage imminent pour la data science"_**]{.blue2}
    + Th√©matique : statistiques sur l'aviation civile
    + Organisation: √©quipes innovation de l'Insee & DGAC <br><br>
- __Point d'entr√©e__ : [inseefrlab.github.io/funathon2024/](https://inseefrlab.github.io/funathon2024/)

:::

:::

::: {.column width="30%"}

![](https://inseefrlab.github.io/funathon2024/img/best_image_funathon.png)

:::

::::

::: {.callout-note collapse="true"}
## Ressources de l'an dernier

L'ensemble des ressources de l'an dernier (_"Du champ √† l'assiette"_) peut √™tre retrouv√©e sur [inseefrlab.github.io/funathon2023/](https://inseefrlab.github.io/funathon2023/)

:::

## Modalit√©s pratiques {.smaller}

- __[√âv√©nement üíØ% virtuel sur 2 jours]{.blue2}__:
    + [Premier jour]{.orange}: introduction √† __9h30__ ;
    + [Deuxi√®me jour]{.orange}: fin du travail sur les sujets √† __16h30__, restitution et conclusion ensuite 

. . .


- __[Assistance sur Tchap et Zoom]{.blue2}__ (liens üëáÔ∏è):
    + Assistance garantie: 10h-17h30 (sauf le midi üçî) ;
    + Ne restez pas bloqu√©s, [posez des questions !]{.orange}

:burger:

::: {.callout-note}
## Liens utiles

- [Canal `Tchap` `Funathon 2024`](https://matrix.to/#/#funathon2024:agent.finances.tchap.gouv.fr)
- [Canal `Zoom`](https://insee-fr.zoom.us/j/94735555913?pwd=dEtLQjg2Y1QrRzl3ei95dkRyOEVXdz09) sur les deux jours
:::

## Les 4 sujets {.smaller}

- __[Ressources {{< fa brands r-project >}} et {{< fa brands python >}} sur *open data* de la DGAC]{.blue2}__ :
  + [2 sujets]{.orange} permettent de faire du {{< fa brands r-project >}}
  + [3 sujets]{.orange} permettent de faire du {{< fa brands python >}}
  + Niveaux techniques indiqu√©s sur les sujets

. . .

- Tutoriels complets __[avec corrections]{.blue2}__
  + Cherchez avant de regarder la correction, c'est le meilleur apprentissage !
  + Objectif secondaire: __[se former √† `Git` {{< fa brands git-alt >}} et √† la reproductibilit√©]{.blue2}__


::: {.callout-note}
## Plus de fun en √©quipe üò∫

N'h√©sitez pas √† traiter les sujets en √©quipe
:::

## Les 4 sujets

__Pr√©sentation des 4 sujets__

![Retrouver les sujets sur [inseefrlab.github.io/funathon2024/](https://inseefrlab.github.io/funathon2024/)](img/sujets_funathon2024.png)


# Le SSP Cloud, c'est quoi ?


## Un environnement id√©al pour la formation {.smaller}

- Plateforme disponible depuis <https://datalab.sspcloud.fr/>
    + Pour d√©couvrir et exp√©rimenter... 
    + ... **Seulement avec des donn√©es en open data**

. . .

- Une plateforme pour l'administration :
    + Ouverte aux agents de l'Etat et √† des formations en _data science_ (ENSAE...)
    + Des serveurs h√©berg√©s √† l'Insee

. . .

::: {.callout-important}

__Plateforme recommand√©e pour cet √©v√©nement__

- Signalez-nous si vous ne pouvez cr√©er de compte !

:::


## Questions
